---
kind: pipeline
type: docker
name: argos-collector-build

platform:
  os: linux
  arch: amd64

steps:
  - name: build
    image: argosnotary/argos-build:latest
    commands:
      - mvn -q install
    volumes:
      - name: mvn_cache
        path: /root/.m2/repository
  - name: pitest
    image: argosnotary/argos-build:latest
    commands:
      - mvn -q -e verify -Ppitest
    volumes:
      - name: mvn_cache
        path: /root/.m2/repository
    depends_on:
      - build

volumes:
  - name: mvn_cache
    temp: {}